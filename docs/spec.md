# ランチ場所決定Webアプリケーション 仕様書

## 1. プロジェクト概要

### アプリケーション名
**Lunch Decider**

### 目的
チームメンバーがWebブラウザを通じて昼食場所を効率的に決定できるアプリケーション

### 基本機能概要
- Webページで条件選択
- 条件に基づく自動場所選択
- 重み付けランダム選択とやり直し機能

## 2. 機能要件

### 2.1 店舗データ管理
**JavaScript内データ構造**：
- **店名**：レストラン名
- **ジャンル**：料理の種類（和食、洋食、中華、イタリアン等）
- **近場かどうか**：boolean（true/false）
- **4人以上入れるか**：boolean（true/false）
- **星の数**：複数人が評価可能（1-5の数値、複数人分記録）
- **新規開拓**：特別な選択肢として含める

### 2.2 条件選択機能
**Webページでの条件選択**：
- ☑️ **近場かどうか**のチェックボックス
- ☑️ **4人以上入れるか**のチェックボックス

**選択ロジック**：
- チェックが入った条件でフィルタリング
- フィルタリング後の店舗から重み付けランダム選択
- 星評価による重み付け（設定可能）

### 2.3 週次ジャンル制限
**制約ルール**：
- 月曜〜金曜の間で同じジャンルは1回のみ選択可能
- 週次の利用履歴をローカルストレージで記録・管理
- 既に選択済みのジャンルは除外してランダム選択

### 2.4 履歴管理
**記録内容**（ローカルストレージ）：
- 日付（曜日）
- 選択された店舗
- 選択されたジャンル
- 永続保存（削除されない）

### 2.5 追加機能
**やり直し機能**：
- 選択結果を確認してからの確定
- 結果が気に入らなければやり直し可能

**重み付け設定**：
- 星評価重み係数の調整可能
- デフォルト1.5倍（1.0〜3.0倍で調整可能）

## 3. データ構造

### 3.1 店舗マスターデータ（JavaScript内定義）
```javascript
const RESTAURANT_DATA = {
  "restaurants": [
    {
      "id": 1,
      "name": "山田食堂",
      "genre": "和食",
      "isNearby": true,
      "canAccommodateFourPlus": true,
      "ratings": [
        {"userId": "田中", "stars": 4},
        {"userId": "佐藤", "stars": 5},
        {"userId": "山田", "stars": 3}
      ]
    }
  ]
}
```

### 3.2 利用履歴データ（ローカルストレージ）
```javascript
[
  {
    "date": "2024-08-12",
    "dayOfWeek": "月",
    "restaurantId": 1,
    "restaurantName": "山田食堂",
    "genre": "和食"
  }
]
```

## 4. 処理フロー

### 4.1 基本処理フロー
1. **Webページアクセス**
2. **条件選択画面表示**
   - 近場チェックボックス
   - 4人以上チェックボックス
3. **「ランチを決める」ボタンクリック**
4. **条件適用**
   - チェック条件でフィルタリング
   - 今週使用済みジャンルを除外
5. **重み付けランダム選択**
   - 星評価による重み付け
   - 残った店舗から選択
6. **結果表示**
   - 選択された店舗情報を表示
   - やり直し・確定ボタン表示
7. **確定処理**
   - 今週の利用履歴に追加（ローカルストレージ）

### 4.2 履歴管理
- 毎週月曜日基準で週次管理
- ローカルストレージに永続保存
- 手動リセット機能あり

## 5. ユーザーインターフェース

### 5.1 アクセス方法
```
https://ganta9.github.io/lunch-decider
```

### 5.2 条件選択画面
```
🍽️ ランチ決定アプリ
条件を選択してください

☐ 近場の店舗に限定
☐ 4人以上入れる店舗に限定

[ランチを決める！]
```

### 5.3 結果表示画面
```
🎯 今日のランチは...

📍 **山田食堂**
🏷️ ジャンル: 和食
⭐ 評価: 4.0 (3人の評価)
📍 近場: ✅
👥 4人以上: ✅

[やり直し] [確定]

📅 今週の利用状況
月: 和食 ✅
火: -
水: -
木: -
金: -
```

## 6. 技術要件

### 6.1 技術スタック
**フロントエンド**:
- **HTML + CSS + JavaScript**: 純粋なWebアプリ
- **レスポンシブデザイン**: PC・スマホ対応

**データ管理**:
- **JavaScript内データ定義**: 外部API不要
- **ローカルストレージ**: 履歴・設定の永続化

**デプロイ**:
- **GitHub Pages**: 無料、簡単セットアップ
- **静的ホスティング**: サーバー不要

### 6.2 ファイル構成
```
lunch-decider/
├── index.html          # メインページ
├── style.css           # スタイルシート
├── script.js           # アプリロジック（データ含む）
├── data/
│   └── restaurants.json # 参考用（使用しない）
├── docs/
│   ├── spec.md         # 仕様書
│   └── fails.md        # 失敗事例
└── README.md           # プロジェクト情報
```

## 7. 制約事項・前提条件

### 7.1 制約
- 週の単位は月曜日開始
- 同一ジャンルは週1回まで選択可能
- ローカルストレージ使用（ブラウザ依存）
- JavaScript有効が必須

### 7.2 エラーハンドリング
- 条件フィルタリング後に店舗が0件の場合
- 今週すべてのジャンルを使い切った場合
- ローカルストレージ読み込みエラー

## 8. 運用方法

### 8.1 基本的な使い方
1. チームでURLを共有
2. 各自がブラウザでアクセス
3. 条件を選択してランチ決定
4. 結果をチームで共有

### 8.2 店舗データの更新
1. GitHubリポジトリの`script.js`を編集
2. `RESTAURANT_DATA`内の店舗情報を追加・修正
3. GitHubにコミット・プッシュ
4. 自動的にWebサイトに反映

### 8.3 メンテナンス
- 履歴リセット機能で過去データクリア可能
- 星評価重み係数の調整可能
- ブラウザのローカルストレージクリアでリセット

---

**作成日**: 2024-08-15  
**バージョン**: 2.0（Webアプリ版）  
**最終更新**: 2024-08-15